"use strict";exports.id=1362,exports.ids=[1362],exports.modules={22074:(a,b,c)=>{c.d(b,{E9:()=>m,Ko:()=>u,Wb:()=>t,X5:()=>k,_3:()=>v,_U:()=>s,i6:()=>y,lr:()=>x,oW:()=>n,u9:()=>w,zK:()=>l});var d=c(2995),e=c(35559);let f=d.Yj().email("Please enter a valid email address"),g=d.Yj().regex(/^(\+\d{1,3}[- ]?)?\d{8,15}$/,"Please enter a valid phone number").optional(),h=d.Yj().min(3,"Postal code must be at least 3 characters").max(10,"Postal code cannot exceed 10 characters"),i=d.Yj().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/\d/,"Password must contain at least one number").regex(/[!@#$%^&*]/,"Password must contain at least one special character"),j=d.Ik({birthDay:d.ai().min(1,"Please select a valid day").max(31,"Please select a valid day"),birthMonth:d.ai().min(1,"Please select a valid month").max(12,"Please select a valid month"),birthYear:d.ai().min(1900,"Please enter a realistic birth year").max(new Date().getFullYear(),"Birth year cannot be in the future"),documentType:d.k5(["id_card","passport","drivers_license"]).optional(),documentNumber:d.Yj().optional(),country:d.Yj().length(2,"Country must be a 2-letter code").optional()}).refine(a=>{let b=new Date(a.birthYear,a.birthMonth-1,a.birthDay);return!isNaN(b.getTime())&&b<=new Date},{message:"Please enter a valid birth date",path:["birthDay"]});d.Ik({email:f,password:i,confirmPassword:d.Yj(),firstName:d.Yj().min(2,"First name must be at least 2 characters").max(50,"First name cannot exceed 50 characters").regex(/^[a-zA-ZÀ-ÿ\s'-]+$/,"First name contains invalid characters"),lastName:d.Yj().min(2,"Last name must be at least 2 characters").max(50,"Last name cannot exceed 50 characters").regex(/^[a-zA-ZÀ-ÿ\s'-]+$/,"Last name contains invalid characters"),phone:g,birthDate:d.Yj().refine(a=>{let b=new Date(a),c=new Date().getFullYear()-b.getFullYear();return!isNaN(b.getTime())&&c>=16&&c<=120},"You must be at least 16 years old to register"),acceptTerms:d.zM().refine(a=>!0===a,"You must accept the terms and conditions"),acceptPrivacy:d.zM().refine(a=>!0===a,"You must accept the privacy policy"),acceptMarketing:d.zM().optional(),country:d.Yj().length(2,"Please select a country")}).refine(a=>a.password===a.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});let k=d.Ik({email:f,password:d.Yj().min(1,"Password is required"),rememberMe:d.zM().optional()}),l=d.Ik({email:f,password:i,confirmPassword:d.Yj(),firstName:d.Yj().min(2,"First name must be at least 2 characters").max(50,"First name cannot exceed 50 characters").regex(/^[a-zA-ZÀ-ÿ\s'-]+$/,"First name contains invalid characters"),lastName:d.Yj().min(2,"Last name must be at least 2 characters").max(50,"Last name cannot exceed 50 characters").regex(/^[a-zA-ZÀ-ÿ\s'-]+$/,"Last name contains invalid characters"),phone:g,birthDate:d.Yj().refine(a=>{let b=new Date(a),c=new Date().getFullYear()-b.getFullYear();return!isNaN(b.getTime())&&c>=18&&c<=120},"You must be at least 18 years old to register"),preferredLanguage:d.k5(["en","fr"]),marketingConsent:d.zM().optional(),newsletterConsent:d.zM().optional(),isBusiness:d.zM().optional(),companyName:d.Yj().min(2,"Company name is required").optional(),vatNumber:d.Yj().regex(/^[A-Z]{2}[0-9A-Z]+$/,"Invalid VAT number format").optional(),termsAccepted:d.zM().refine(a=>!0===a,"You must accept the terms and conditions"),privacyAccepted:d.zM().refine(a=>!0===a,"You must accept the privacy policy")}).refine(a=>a.password===a.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}).refine(a=>!a.isBusiness||a.companyName&&a.companyName.length>=2,{message:"Company name is required for business accounts",path:["companyName"]}),m=d.Ik({email:f}),n=d.Ik({token:d.Yj().min(1,"Reset token is required"),password:i,confirmPassword:d.Yj()}).refine(a=>a.password===a.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});d.Ik({currentPassword:d.Yj().min(1,"Current password is required"),newPassword:i,confirmPassword:d.Yj()}).refine(a=>a.newPassword===a.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});let o=d.Ik({firstName:d.Yj().min(2,"First name is required"),lastName:d.Yj().min(2,"Last name is required"),company:d.Yj().optional(),address:d.Yj().min(5,"Street address is required"),address2:d.Yj().optional(),city:d.Yj().min(2,"City is required"),postalCode:h,country:d.Yj().length(2,"Please select a country"),phone:g}),p=d.Ik({email:f,firstName:d.Yj().min(2,"First name is required"),lastName:d.Yj().min(2,"Last name is required"),phone:g,createAccount:d.zM().optional(),password:d.Yj().optional()}).refine(a=>!a.createAccount||a.password&&a.password.length>=8,{message:"Password is required when creating an account",path:["password"]}),q=o.extend({sameAsShipping:d.zM().optional()}),r=d.Ik({paymentMethod:d.k5(["mollie","stripe","paypal"]),savePaymentMethod:d.zM().optional(),acceptTerms:d.zM().refine(a=>!0===a,"You must accept the terms and conditions")});d.Ik({customer:p,shipping:o,billing:q,payment:r,ageVerification:j,vatNumber:d.Yj().optional(),specialInstructions:d.Yj().max(500,"Special instructions cannot exceed 500 characters").optional()});let s=d.Ik({productId:d.Yj().uuid("Invalid product ID"),quantity:d.ai().min(1,"Quantity must be at least 1").max(24,"Maximum 24 bottles per product").int("Quantity must be a whole number"),variantId:d.Yj().optional()}),t=d.Ik({itemId:d.Yj().uuid("Invalid cart item ID"),quantity:d.ai().min(0,"Quantity must be 0 or more").max(24,"Maximum 24 bottles per product").int("Quantity must be a whole number")});d.Ik({name:d.Yj().min(3,"Product name must be at least 3 characters").max(100,"Product name cannot exceed 100 characters"),sku:d.Yj().min(3,"SKU must be at least 3 characters").max(50,"SKU cannot exceed 50 characters").regex(/^[A-Z0-9-]+$/,"SKU must contain only uppercase letters, numbers, and hyphens"),description:d.Yj().min(10,"Description must be at least 10 characters").max(2e3,"Description cannot exceed 2000 characters"),price:d.ai().min(1,"Price must be at least €0.01").max(1e5,"Price cannot exceed €1,000.00"),stockQuantity:d.ai().min(0,"Stock quantity cannot be negative").max(1e4,"Stock quantity cannot exceed 10,000").int("Stock quantity must be a whole number"),category:d.k5(["red_wine","white_wine","rose_wine","sparkling_wine","dessert_wine","fortified_wine"]),vintage:d.ai().min(1800,"Vintage must be realistic").max(new Date().getFullYear(),"Vintage cannot be in the future").optional(),alcoholContent:d.ai().min(.5,"Alcohol content must be at least 0.5%").max(20,"Alcohol content cannot exceed 20%").optional(),grapeVariety:d.Yj().max(100,"Grape variety name too long").optional(),region:d.Yj().max(100,"Region name too long").optional(),producer:d.Yj().max(100,"Producer name too long").optional(),volume:d.ai().min(187,"Minimum volume is 187ml").max(3e3,"Maximum volume is 3000ml").optional(),servingTemperature:d.Yj().max(50,"Serving temperature description too long").optional(),agingPotential:d.Yj().max(100,"Aging potential description too long").optional(),pairingNotes:d.Yj().max(500,"Pairing notes too long").optional(),status:d.k5(["active","inactive","out_of_stock","discontinued"]),isFeatured:d.zM().optional(),isOrganic:d.zM().optional(),isBiodynamic:d.zM().optional(),imageUrl:d.Yj().url("Please enter a valid image URL").optional(),galleryImages:d.YO(d.Yj().url()).max(10,"Maximum 10 gallery images").optional()});let u=d.Ik({customerId:d.Yj().uuid("Invalid customer ID").optional(),customerEmail:f,customerFirstName:d.Yj().min(2,"First name is required"),customerLastName:d.Yj().min(2,"Last name is required"),shippingAddress:o,billingAddress:o,items:d.YO(d.Ik({productId:d.Yj().uuid("Invalid product ID"),quantity:d.ai().min(1,"Quantity must be at least 1").int(),unitPrice:d.ai().min(1,"Unit price must be positive")})).min(1,"Order must contain at least one item"),subtotal:d.ai().min(0,"Subtotal cannot be negative"),vatAmount:d.ai().min(0,"VAT amount cannot be negative"),shippingCost:d.ai().min(0,"Shipping cost cannot be negative"),totalAmount:d.ai().min(1,"Total amount must be positive"),paymentMethod:d.Yj().min(1,"Payment method is required"),specialInstructions:d.Yj().max(500,"Special instructions too long").optional(),giftMessage:d.Yj().max(200,"Gift message too long").optional()});d.Ik({name:d.Yj().min(2,"Name must be at least 2 characters").max(100,"Name cannot exceed 100 characters"),email:f,subject:d.Yj().min(5,"Subject must be at least 5 characters").max(100,"Subject cannot exceed 100 characters"),message:d.Yj().min(10,"Message must be at least 10 characters").max(1e3,"Message cannot exceed 1000 characters"),phone:g,category:d.k5(["general","orders","products","shipping","returns","technical"]).optional()}),d.Ik({email:f,firstName:d.Yj().min(2,"First name is required").optional(),preferences:d.Ik({newProducts:d.zM().optional(),specialOffers:d.zM().optional(),wineEvents:d.zM().optional(),wineEducation:d.zM().optional()}).optional(),acceptTerms:d.zM().refine(a=>!0===a,"You must accept the terms and conditions")}),d.Ik({email:f,password:d.Yj().min(1,"Password is required"),twoFactorCode:d.Yj().regex(/^\d{6}$/,"2FA code must be 6 digits").optional()}),d.Ik({email:f,firstName:d.Yj().min(2,"First name is required"),lastName:d.Yj().min(2,"Last name is required"),role:d.k5(["admin","manager","staff"]),permissions:d.YO(d.Yj()).optional(),isActive:d.zM(),password:i.optional()}),d.Ik({productId:d.Yj().uuid("Invalid product ID"),adjustment:d.ai().min(-1e3,"Adjustment too large").max(1e3,"Adjustment too large").int("Adjustment must be a whole number"),reason:d.k5(["received","sold","damaged","expired","returned","correction","other"]),notes:d.Yj().max(500,"Notes cannot exceed 500 characters").optional(),reference:d.Yj().max(100,"Reference cannot exceed 100 characters").optional()});let v=d.Ik({destination:d.Ik({country:d.Yj().length(2,"Country must be a 2-letter code"),postalCode:h,city:d.Yj().min(2,"City is required")}),items:d.YO(d.Ik({productId:d.Yj().uuid("Invalid product ID"),quantity:d.ai().min(1,"Quantity must be at least 1").int(),weight:d.ai().min(1,"Weight must be positive").optional()})).min(1,"At least one item is required"),totalValue:d.ai().min(1,"Total value must be positive")}),w=d.Ik({amount:d.ai().min(1,"Amount must be positive"),shippingAmount:d.ai().min(0,"Shipping amount cannot be negative").optional(),country:d.Yj().length(2,"Country must be a 2-letter code"),customerType:d.k5(["consumer","business"]).optional(),vatNumber:d.Yj().optional()}),x=d.Ik({query:d.Yj().max(100,"Search query too long").optional(),category:d.k5(["red_wine","white_wine","rose_wine","sparkling_wine","dessert_wine","fortified_wine"]).optional(),minPrice:d.ai().min(0,"Minimum price cannot be negative").optional(),maxPrice:d.ai().min(0,"Maximum price cannot be negative").optional(),vintage:d.ai().min(1800,"Vintage too old").max(new Date().getFullYear(),"Vintage cannot be in the future").optional(),region:d.Yj().max(100,"Region name too long").optional(),inStock:d.zM().optional(),isOrganic:d.zM().optional(),sortBy:d.k5(["name","price","vintage","created_at","popularity"]).optional(),sortOrder:d.k5(["asc","desc"]).optional(),limit:d.ai().min(1,"Limit must be at least 1").max(100,"Limit cannot exceed 100").optional(),offset:d.ai().min(0,"Offset cannot be negative").optional()});d.Ik({file:d.bz().refine(a=>a instanceof File,"Please select a valid file").refine(a=>a.size<=5242880,"File size must be less than 5MB").refine(a=>["image/jpeg","image/png","image/webp"].includes(a.type),"File must be JPEG, PNG, or WebP format"),alt:d.Yj().max(200,"Alt text cannot exceed 200 characters").optional()});let y=(a,b)=>{try{let c=a.parse(b);return{success:!0,data:c}}catch(a){if(a instanceof e.G){let b={};for(let c of a.issues){let a=c.path.join(".");b[a]||(b[a]=[]),b[a].push(c.message)}return{success:!1,errors:b}}return{success:!1,errors:{general:["Validation failed"]}}}}},94649:(a,b,c)=>{c.d(b,{iM:()=>g});class d{constructor(){if(this.apiKey=process.env.SENDCLOUD_PUBLIC_KEY||"",this.apiSecret=process.env.SENDCLOUD_SECRET_KEY||"",this.baseUrl="https://panel.sendcloud.sc/api/v2",this.isTestMode=!1,!this.apiKey||!this.apiSecret)throw Error("SENDCLOUD_PUBLIC_KEY and SENDCLOUD_SECRET_KEY environment variables are required")}async getShippingMethods(a,b,c){let d=new URLSearchParams({to_country:a.toUpperCase()});return b&&d.append("weight",b.toString()),c&&d.append("value",(c/100).toString()),(await this.makeRequest("GET",`/shipping_methods?${d.toString()}`)).shipping_methods||[]}async calculateRates(a,b){return(await this.getShippingMethods(a.country,b.weight,b.value)).filter(b=>this.isWineCompatibleMethod(b,a.country)).map(a=>({shipping_method:a,price:a.price,currency:a.currency,delivery_time:a.delivery_time,service_point_required:"required"===a.service_point_input}))}async createShipment(a,b,c){let d={parcel:{...a,weight:a.weight.toString(),shipping_method:b,service_point:c,customs_declaration:{contents:1,invoice_number:a.order_number,weight:a.weight,items:[{description:"Wine",quantity:a.quantity||1,weight:a.weight,value:Math.round((a.total_order_value||0)/100),hs_code:"220421",origin_country:"FR"}]}}};return(await this.makeRequest("POST","/parcels",d)).parcel}async getShipment(a){return(await this.makeRequest("GET",`/parcels/${a}`)).parcel}async cancelShipment(a){try{return await this.makeRequest("POST",`/parcels/${a}/cancel`),!0}catch(a){return console.error("Failed to cancel shipment:",a),!1}}async getTracking(a){let b=await this.getShipment(a);return{tracking_number:b.tracking_number||"",tracking_url:b.tracking_url||"",status:b.status,status_message:this.getStatusMessage(b.status)}}async findServicePoints(a,b,c,d=5){let e=new URLSearchParams({country:a.toUpperCase(),postal_code:b,limit:d.toString()});return c&&e.append("carrier",c),(await this.makeRequest("GET",`/service_points?${e.toString()}`)).service_points||[]}async generateLabel(a,b="pdf"){return await this.makeRequest("GET",`/labels/${b}?ids=${a}`)}isWineCompatibleMethod(a,b){return!!a.characteristics.is_tracked&&!["amazon","fedex_envelope"].includes(a.carrier.toLowerCase())&&(!["US","CA","AU"].includes(b.toUpperCase())||a.characteristics.is_express||a.characteristics.requires_signature)}getStatusMessage(a){return({announced:"Shipment announced",en_route_to_sorting_center:"En route to sorting center",delivered_at_sorting_center:"Delivered at sorting center",sorted:"Package sorted",en_route:"Out for delivery",delivered:"Delivered",exception:"Delivery exception",unknown:"Status unknown"})[a]||"Unknown status"}async makeRequest(a,b,c){let d=`${this.baseUrl}${b}`,f=Buffer.from(`${this.apiKey}:${this.apiSecret}`).toString("base64"),g={method:a,headers:{Authorization:`Basic ${f}`,"Content-Type":"application/json"}};c&&(g.body=JSON.stringify(c));try{let a=await fetch(d,g);if(!a.ok){let b=await a.json().catch(()=>({}));throw new e(b.error?.message||"Shipping API error",a.status,b.error?.code||a.statusText,b)}return await a.json()}catch(a){if(a instanceof e)throw a;throw new e("Shipping service unavailable",500,"Unable to connect to shipping provider",{originalError:a})}}}class e extends Error{constructor(a,b,c,d){super(a),this.name="SendcloudError",this.status=b,this.code=c,this.data=d}toJSON(){return{name:this.name,message:this.message,status:this.status,code:this.code,data:this.data}}}let f=new d,g=async(a,b,c)=>{let d=Math.max(200,50*b);return f.calculateRates({country:a.country,postal_code:a.postal_code,city:a.city},{weight:750*b+d,value:c,length:b<=6?35:45,width:b<=6?25:35,height:b<=6?30:35})}}};